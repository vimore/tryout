morphlines : [
  {
    id: leef
    importCommands: ["org.kitesdk.morphline.**", "com.securityx.model.mef.morphline.**"]
    commands: [
      {

        tsvq {
          inputFieldName: "leefInput",
          fieldSep: "|",
          quoteChar: "\"",
          trim: true,
          greedy: true,
          fieldNames: [
            "leefHeader",
            "leefDeviceVendor",
            "leefDeviceProduct",
            "leefDeviceVersion",
            "leefSignatureId",
            "leefExtensionData"
          ]
        }
      },
      {
        addKeyValuesIfMissing {
          leefProductKey : "@{leefDeviceVendor}-@{leefDeviceProduct}",
        }
      },
      {
        scriptSelector {
          scripts: [
            {
              logicalName: "leef_websense",
              morphlineFile: "logcollection-leef.conf",
              morphlineId: "leef_websense"
              transferFieldNamedToMessage: "leefExtensionData"
              fullCopy: true
            },
            {
              logicalName: "leef_mcafeewebsec",
              morphlineFile: "webproxymef-mcafee_websecurity.conf",
              morphlineId: "leef_mcafeewebsec"
              transferFieldNamedToMessage: "leefExtensionData"
                messageFieldName: "leef_websecMessage"
              fullCopy: true
            },
            {
              logicalName: "leef_BCN_Adonis",
              morphlineFile: "hetmef-bcn_adonis-dhcp.conf",
              morphlineId: "leef_bcnadonis"
              transferFieldNamedToMessage: "leefExtensionData"
              messageFieldName: "leef_adonisMessage"
              fullCopy: true
            }
          ]
          ################################################################################
          selectors: [
            {
              # dpi-http events
              pattern: "^Websense-Security"
              logicalScriptName: ["leef_websense"]
              readFromFieldNamed: "leefProductKey"
              subPatterns: []
            },
            {
              # dpi-dns events
              pattern: "^McAfee-Web Gateway"
              logicalScriptName: ["leef_mcafeewebsec"]
              readFromFieldNamed: "leefProductKey"
              subPatterns: []
            },
            {
              pattern: "^BCN-Adonis"
              logicalScriptName: ["leef_BCN_Adonis"]
              readFromFieldNamed: "leefProductKey"
              subPatterns: []
            }
          ]
        }# scriptSelector end
      }
    ]
  },
  {
    id: leef_websense
    importCommands: ["org.kitesdk.morphline.**", "com.securityx.model.mef.morphline.**"]
    commands: [

      {
        cefKvpSplitter  {
          inputFieldName : "leefExtensionData" ,
          formatKeySet : ["leefWebsenseSecurity"],
          fieldHeaderPattern: "(?:\\s+|^|#011)?",
          trim : true
        }
      },
      {
        addKeyValuesIfMissing  {
          logSourceType : "leefWebsenseSecurity"
          deviceNameOrIp : "@{logCollectionHost}"
          startTime: "@{receiptTime}"
          sourceNameOrIp: "@{sourceAddress}"
          url: ""
        }
      },

      {
        grok {
          dictionaryString : """
            LEEF_HDRPREFIX LEEF
            LEEF_HDRVERSION [^\|]
            LEEF_ACTION [^:]+
          """
          expressions : {
            leefHeader : """%{LEEF_HDRPREFIX}:\s*%{LEEF_HDRVERSION:leefHeaderVersion}"""
            leefSignatureId : """transaction:%{LEEF_ACTION:deviceAction}"""
          }
          extract : true,
          findSubstrings : true,
          addEmptyStrings : false
        }
      },
      {
        urlExtract {
          inputFieldName : "url",
          destFields : ["requestScheme", "destinationUserName", "destinationNameOrIp", "_destinationPort", "requestPath", "requestQuery"]
        }
      },
      {
        webProxyMefFormat {
          formatIdFromFieldName : "logSourceType",
          discardUnmappableFields : "false",
          discardOriginalMappedFields :  "true"
        }
      },
      {
        validateSupportedFormat {
          failOnUnknownFields: "false"
          defaultFormat: "WebProxyMef"
        }
      }


    ]
  }
]