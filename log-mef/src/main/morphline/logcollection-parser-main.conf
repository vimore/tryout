morphlines: [
  {
    id: parsermain
    importCommands: [ "org.kitesdk.morphline.**", "com.securityx.model.mef.morphline.**"]

    commands: [
      {
        if {
          conditions: [
            {contains {logCollectionCategory: ["tanium", "flume_tanium", "tanium_feed", "tanium_csv"]}}
          ]
          then: [
            {
              if {
                conditions: [
                  {not {equals {taniumQuestion: []}}}  #test if field is present and not empty
                ]
                then: [
                  {
                    harnessCmd {
                      morphlineFile: "flume_tanium-script-selector.conf"
                      morphlineId: "taniumscriptselector"
                      fullCopy: true
                    }
                  }
                ]
                else: [
                  {
                    harnessCmd {
                      morphlineFile: "tanium-json.conf"
                      morphlineId: "tanium-json"
                      fullCopy: true
                    }
                  },

                  {
                    harnessCmd {
                      morphlineFile: "tanium-script-selector.conf"
                      morphlineId: "taniumscriptselector"
                      fullCopy: true
                    }
                  }
                ]
              }
            }

          ]
          else: [
            {
              if {
                conditions: [
                  {contains {logCollectionCategory: [activedirectory]}}
                ]
                then: [
                  {
                    harnessCmd {
                      morphlineFile: "logcollection-syslog.conf"
                      morphlineId: "sysloglogcollection"
                      fullCopy: true

                    }
                  },
                  {
                    harnessCmd {
                      morphlineFile: "logcollection-cef.conf"
                      morphlineId: "cefnew"
                      fullCopy: true
                    }
                  },

                  {
                    if {
                      conditions: [
                        {contains {cefDeviceProduct: [EventLog]}}
                      ]
                      then: [
                        {
                          harnessCmd {
                            morphlineFile: "windowssplunkcef-to-mef.conf"
                            morphlineId: "windowssplunkcef"
                            fullCopy: true
                          }
                        }
                      ]
                      else: [
                        {
                          if {
                            conditions: [
                              {contains {cefDeviceProduct: [dhcpd]}}
                            ]
                            then: [
                              {
                                harnessCmd {
                                  morphlineFile: "dhcpdsplunkcef-to-mef.conf"
                                  morphlineId: "dhcpdsplunkcef"
                                  fullCopy: true
                                }
                              }
                            ]
                            else: [
                              {
                                if {
                                  conditions: [
                                    {contains {cefDeviceProduct: ["Arcsight"]}}
                                  ]
                                  then: [
                                    {
                                      harnessCmd {
                                        morphlineFile: "siemincidentmef-cef.conf"
                                        morphlineId: "cefincident"
                                        fullCopy: true
                                      }
                                    }
                                  ]
                                  else: [

                                  ]
                                }
                              }
                            ]
                          }
                        }
                      ]
                    }
                  }
                ]
                else: [
                  {
                    if {
                      conditions: [
                        {contains {logCollectionCategory: [packet]}}
                      ]
                      then: [
                        {
                          harnessCmd {
                            morphlineFile: "dpi-json.conf"
                            morphlineId: "dpi-json"
                            fullCopy: true
                          }
                        },

                        {
                          harnessCmd {
                            morphlineFile: "dpi-script-selector.conf"
                            morphlineId: "dpiscriptselector"
                            fullCopy: true
                          }
                        }
                      ]
                      else: [
                        {
                          if {
                            conditions: [
                              {contains {logCollectionCategory: [nprobe]}}
                            ]
                            then: [
                              {
                                if {
                                  conditions: [
                                    {contains {logCollectionHost: [ip-192-168-12-16.ec2.internal]}}
                                  ]
                                  then: [
                                    {
                                      harnessCmd {
                                        morphlineFile: "flowmef-nprobe.conf"
                                        morphlineId: "nprobenetflowcollectorKVP"
                                        fullCopy: true
                                      }
                                    }
                                  ]
                                  else: [
                                    {
                                      harnessCmd {
                                        morphlineFile: "flowmef-nprobe.conf"
                                        morphlineId: "nprobe"
                                        transferFieldNamedToMessage: "message"

                                        fullCopy: true
                                      }
                                    }
                                  ]
                                }
                              }
                            ]
                            else: [
                              {
                                if {
                                  conditions: [
                                    {contains {logCollectionHost: [host-web_behavior]}}
                                  ]
                                  then: [
                                    {
                                      harnessCmd {
                                        morphlineFile: "logcollection-bluecoat-1y-selector.conf",
                                        morphlineId: "1y-scriptselector",
                                        transferFieldNamedToMessage: "message"
                                        messageFieldName: "message"
                                      }
                                    }
                                  ]
                                  else: [
                                    {
                                      if {
                                        conditions: [
                                          {contains {logCollectionHost: [bluecoat-laposte]}}
                                        ]
                                        then: [
                                          {
                                            harnessCmd {
                                              morphlineFile: "logcollection-bluecoat.conf",
                                              morphlineId: "bluecoat-laposte",
                                              transferFieldNamedToMessage: "message"
                                              messageFieldName: "message"
                                            }
                                          }
                                        ]
                                        else: [
                                          {
                                            harnessCmd {
                                              morphlineFile: "logcollection-syslog-script-selector.conf"
                                              morphlineId: "syslogscriptselector"
                                              fullCopy: true
                                            }
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                }
                              }
                            ]
                          }
                        }

                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    ]
  }
]
