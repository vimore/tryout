package com.securityx.logcollection.parser.utils;

import com.securityx.logcollection.utils.RegexUtils;
import com.securityx.utils.OutUtils;
import junit.framework.TestCase;

import java.util.regex.Pattern;

public class RegexValitionTest  extends TestCase{

    public void test_validregex(){
        Pattern P = Pattern.compile("(?:<\\d+>)?(\\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sep(?:tember)?|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)\\b\\s+(?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9])\\s(?!<[0-9])(?:2[0123]|[01]?[0-9]):(?:[0-5][0-9])(?::(?:(?:[0-5][0-9]|60)(?:[:.,][0-9]+)?))(?![0-9]))\\s((?:\\b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\\.?|\\b)|(?<![0-9])(?:(?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2}))(?![0-9])))\\s(.*)");
        String str = "Jun 18 16:34:44 host2 CEF:0|IntersectAlliance|Snare||Microsoft-Windows-Security-Auditing:4769|A Kerberos service ticket was requested|Low| eventId=975425144 externalId=4769 msg=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.  categorySignificance=/Normal categoryBehavior=/Authentication/Verify categoryDeviceGroup=/Operating System catdt=Log Consolidator categoryOutcome=/Attempt categoryObject=/Host/Operating System art=1434663284564 cat=Security deviceSeverity=4 rt=1434652483000 spt=64304 dhost=XXXXX.RB.AD.JPMORGANCHASE.COM dntdom=JPMORGANCHASE.COM duser=XX1111111111112$@JPMORGANCHASE.COM destinationServiceName=krbtgt/JPMORGANCHASE.COM cs2=Kerberos Service Ticket Operations cs3=::ffff:10.9.7.5 cs4=0xe cs6={00000000-0000-0000-0000-000000000000} c6a2=0:0:0:0:0:ffff::a5 cs1Label=Accesses cs2Label=EventlogCategory cs3Label=Client Address cs4Label=Reason or Error Code cs5Label=Authentication Package Name cs6Label=Logon GUID cn1Label=LogonType cn2Label=CrashOnAuditFail cn3Label=Count c6a2Label=Source IPv6 Address ahost=host1.svr.us.jpmchase.net agt=10.5.137.64 agentZoneURI=/All Zones/ArcSight System/Public Address Space Zones/ARIN/164.0.0.0-169.253.255.255 (ARIN) av=7.0.5.7132.0 atz=America/New_York aid=3Kwbn4UkBABCBy0OBjJe9TA\\=\\= at=syslog dvchost=XXXXX.JPMORGANCHASE.COM dtz=America/New_York _cefVer=0.1 ad.ExtraParam0=This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested. ad.Service_,Information:Service_,ID=S-1-0-0 ad.Additional_,InMbHgGQ_~_~Ticket_,Options=0x60810010 ad.Additional_,Inc1+cZg_~_~sited_,Services=- ad.ExtraParam1=This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket. ad.ExtraParam2=Ticket options, encryption types, and failure codes are defined in RFC 4120. ad.Additional_,InagWMqg_~_~ncryption_,Type=0xffffffff ad.message=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.     User: JPMORGANCHASE.COM\\XX1111111111112$@JPMORGANCHASE.COM     ComputerName: XXXXX.JPMORGANCHASE.COM";
        ;
         //str = "Jun 18 16:34:44 host2 toto";


        OutUtils.printOut(RegexUtils.biggestMatch(P, str));
    }
}
