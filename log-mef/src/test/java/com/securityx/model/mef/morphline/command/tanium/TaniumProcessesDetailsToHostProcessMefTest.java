package com.securityx.model.mef.morphline.command.tanium;

import com.securityx.logcollection.utils.MorphlineResourceLoader;
import com.securityx.model.mef.morphline.command.LogCollectionAbstractTest;
import com.securityx.model.mef.morphline.command.util.AssertRecordOutCommand;
import com.securityx.model.mef.morphline.utils.MorphlineHarness;
import com.securityx.utils.OutUtils;
import com.typesafe.config.Config;
import junit.framework.Assert;
import org.kitesdk.morphline.api.Record;
import org.kitesdk.morphline.base.Fields;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.testng.annotations.Test;

import java.io.ByteArrayInputStream;
import java.io.FileNotFoundException;

public class TaniumProcessesDetailsToHostProcessMefTest extends LogCollectionAbstractTest {

    private Logger logger = LoggerFactory.getLogger(TaniumProcessesDetailsToHostProcessMefTest.class);
    private MorphlineHarness morphlineTanium2Json;
    private AssertRecordOutCommand tanium2JsonOutCommand;

    public TaniumProcessesDetailsToHostProcessMefTest() throws Exception {
        super(TaniumProcessesDetailsToHostProcessMefTest.class.toString());
        this.tanium2JsonOutCommand = new AssertRecordOutCommand(morphlineContext);
        Config conf = MorphlineResourceLoader.getConfFile("tanium-json.conf");
        assertTrue("conf file " + conf.origin(), conf.origin().toString().contains("tanium-json"));
        this.morphlineTanium2Json = new MorphlineHarness(morphlineContext, conf, "tanium-json");
        this.morphlineTanium2Json.startup(tanium2JsonOutCommand);
        this.morphlineId = "tanium-process_details";
        this.confFile = "hostprocessmef-tanium-process_details.conf";
        this.setUp();
    }

    private Record buildRecord(String line) {
        Record input = new Record();
        input.put(Fields.ATTACHMENT_BODY, new ByteArrayInputStream(line.getBytes()));
        input.put(Fields.ATTACHMENT_MIME_TYPE,"application/json");
        boolean result = this.morphlineTanium2Json.feedRecords(input);
        assertEquals(true, result);
        OutUtils.printOut(this.tanium2JsonOutCommand.getNumRecords());
        Assert.assertTrue(this.tanium2JsonOutCommand.getNumRecords() == 1);
        Record out = this.tanium2JsonOutCommand.getRecord(0);
        this.tanium2JsonOutCommand.clear();
        return out;
    }

    @Test
    public void test_simple() throws FileNotFoundException {
        String line = "{\"question\": \"Host-Processes details v2\", \"measure\": \"\\n<result_sets><now>2015/06/08 09:01:30 GMT-0000</now>\\n<result_set><age>0</age><archived_question_id>0</archived_question_id><saved_question_id>252</saved_question_id><question_id>219864</question_id><report_count>6</report_count><seconds_since_issued>0</seconds_since_issued><issue_seconds>120</issue_seconds><expire_seconds>600</expire_seconds><tested>9</tested><passed>9</passed><mr_tested>9</mr_tested><mr_passed>9</mr_passed><estimated_total>9</estimated_total><select_count>1</select_count><cs><c><wh>2225394095</wh><dn>Hostname</dn><rt>1</rt></c><c><wh>2225394095</wh><dn>ProcessName</dn><rt>1</rt></c><c><wh>2225394095</wh><dn>md5</dn><rt>1</rt></c><c><wh>2225394095</wh><dn>ProcessPath</dn><rt>1</rt></c><c><wh>2225394095</wh><dn>ProcessPorts</dn><rt>1</rt></c><c><wh>0</wh><dn>Count</dn><rt>3</rt></c></cs><filtered_row_count>93</filtered_row_count><filtered_row_count_machines>99</filtered_row_count_machines><item_count>93</item_count><rs><r><id>0</id><cid>0</cid><c><v>[no results]</v></c><c><v></v></c><c><v></v></c><c><v></v></c><c><v></v></c><c><v>7</v></c></r><r><id>4964764</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>sublime_text.exe</v></c><c><v>1a62f67f5d9c292ba8a615ea6797966d c:\\\\users\\\\akshat\\\\desktop\\\\sublime text build 3083 x64\\\\sublime_text.exe</v></c><c><v>C:\\\\Users\\\\akshat\\\\Desktop\\\\Sublime Text Build 3083 x64\\\\sublime_text.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>130135404</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>mmc.exe</v></c><c><v>6aaf3bece2c3d17091bcef37c5a82ac0 c:\\\\windows\\\\system32\\\\mmc.exe</v></c><c><v>C:\\\\Windows\\\\system32\\\\mmc.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>135538545</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>nvvsvc.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\nvvsvc.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>200259006</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>LiteAgent.exe</v></c><c><v>78d3824650a866f3c38ae0079fc7e3dd c:\\\\program files\\\\amazon\\\\xentools\\\\liteagent.exe</v></c><c><v>C:\\\\Program Files\\\\Amazon\\\\XenTools\\\\LiteAgent.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>214928457</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>LogonUI.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\LogonUI.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>240362891</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>rdpclip.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\System32\\\\rdpclip.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>328579443</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>cmd.exe</v></c><c><v>ad7b9c14083b52bc532fba5948342b98 c:\\\\windows\\\\system32\\\\cmd.exe</v></c><c><v>C:\\\\Windows\\\\System32\\\\cmd.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>362478771</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>fdhost.exe</v></c><c><v>1b100b5fc879b899f9ef85392c90a79c c:\\\\program files\\\\microsoft sql server\\\\mssql12.mssqlserver\\\\mssql\\\\binn\\\\fdhost.exe</v></c><c><v>C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL12.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\fdhost.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>430230444</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>fdlauncher.exe</v></c><c><v>c5e1fe7db2202d37ba9a634e7f230a44 c:\\\\program files\\\\microsoft sql server\\\\mssql12.mssqlserver\\\\mssql\\\\binn\\\\fdlauncher.exe</v></c><c><v>C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL12.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\fdlauncher.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>460833048</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>firefox.exe</v></c><c><v>345b45be09381d2011eb7f9ac11d8ac4 c:\\\\program files (x86)\\\\mozilla firefox\\\\firefox.exe</v></c><c><v>C:\\\\Program Files (x86)\\\\Mozilla Firefox\\\\firefox.exe</v></c><c><v>11112 {TCP/127.0.0.1:63700,TCP/127.0.0.1:63701}</v></c><c><v>1</v></c></r><r><id>488066177</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>System</v></c><c><v>[NO BIN]</v></c><c><v></v></c><c><v></v></c><c><v>1</v></c></r><r><id>489839558</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>explorer.exe</v></c><c><v>332feab1435662fc6c672e25beb37be3 c:\\\\windows\\\\explorer.exe</v></c><c><v>C:\\\\Windows\\\\Explorer.EXE</v></c><c><v></v></c><c><v>1</v></c></r><r><id>525975750</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>TaniumClient.exe</v></c><c><v>0db1ccd7230fdee1adb04e536ea60759 c:\\\\program files (x86)\\\\tanium\\\\tanium client\\\\taniumclient.exe</v></c><c><v>C:\\\\Program Files (x86)\\\\Tanium\\\\Tanium Client\\\\TaniumClient.exe</v></c><c><v>32 {TCP/10.167.170.124:65185,TCP/127.0.0.1:65150}</v></c><c><v>1</v></c></r><r><id>554946170</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>wscript.exe</v></c><c><v>979d74799ea6c8b8167869a68df5204a c:\\\\windows\\\\system32\\\\wscript.exe</v></c><c><v>C:\\\\Windows\\\\System32\\\\WScript.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>587507959</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>winlogon.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\winlogon.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>704071111</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>cmd.exe</v></c><c><v>622d21c40a25f9834a03bfd5ff4710c1 c:\\\\windows\\\\system32\\\\cmd.exe</v></c><c><v>C:\\\\Windows\\\\system32\\\\cmd.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>742390788</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>wscript.exe</v></c><c><v>d536ccce2a7992688db76941506ea970 c:\\\\windows\\\\system32\\\\wscript.exe</v></c><c><v>C:\\\\Windows\\\\System32\\\\WScript.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>752500312</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>taskmgr.exe</v></c><c><v>545bf7eaa24a9e062857d0742ec0b28a c:\\\\windows\\\\system32\\\\taskmgr.exe</v></c><c><v>C:\\\\Windows\\\\system32\\\\taskmgr.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>806209098</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>powershell.exe</v></c><c><v>ef8fa4f195c6239273c100ab370fcfdc c:\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\powershell.exe</v></c><c><v>C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>868409369</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>spoolsv.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\System32\\\\spoolsv.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>868772106</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>smss.exe</v></c><c><v>[NO BIN]</v></c><c><v></v></c><c><v></v></c><c><v>1</v></c></r><r><id>930388804</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>chrome.exe</v></c><c><v>c4ef32c1c0473392ef4204890af8e457 c:\\\\program files (x86)\\\\google\\\\chrome\\\\application\\\\chrome.exe</v></c><c><v>C:\\\\Program Files (x86)\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>950785313</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>XenDpriv.exe</v></c><c><v>637c075ca92a0e272029f53b345d1bfd c:\\\\program files (x86)\\\\citrix\\\\xentools\\\\xendpriv.exe</v></c><c><v>C:\\\\Program Files (x86)\\\\Citrix\\\\XenTools\\\\XenDpriv.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>969791269</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>conhost.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\conhost.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1027493949</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>wininit.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\wininit.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1045242840</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>regedit.exe</v></c><c><v>2f3fed31ac2846d8ad5dbc396a7e3df1 c:\\\\windows\\\\regedit.exe</v></c><c><v>C:\\\\Windows\\\\regedit.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1052137475</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>notepad.exe</v></c><c><v>8bab7a5d5c1477d0641195e623db32b4 c:\\\\windows\\\\system32\\\\notepad.exe</v></c><c><v>C:\\\\Windows\\\\System32\\\\Notepad.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1056487211</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>msdtc.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\System32\\\\msdtc.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1178014734</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>csrss.exe</v></c><c><v>[NO BIN]</v></c><c><v>C:\\\\Windows\\\\sysWOW64\\\\wbem\\\\wmiprvse.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1192001015</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>System</v></c><c><v>[NO BIN]</v></c><c><v></v></c><c><v></v></c><c><v>1</v></c></r><r><id>1197626474</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>sqlwriter.exe</v></c><c><v>8fd8ee71d7d639f85805eee4adb2aa15 c:\\\\program files\\\\microsoft sql server\\\\90\\\\shared\\\\sqlwriter.exe</v></c><c><v>C:\\\\Program Files\\\\Microsoft SQL Server\\\\90\\\\Shared\\\\sqlwriter.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1232513977</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>TaniumClient.exe</v></c><c><v>0db1ccd7230fdee1adb04e536ea60759 c:\\\\program files (x86)\\\\tanium\\\\tanium client\\\\taniumclient.exe</v></c><c><v>C:\\\\Program Files (x86)\\\\Tanium\\\\Tanium Client\\\\TaniumClient.exe</v></c><c><v>4044 {TCP/192.168.12.27:53180,TCP/192.168.12.27:53206,TCP/192.168.12.27:53209}</v></c><c><v>1</v></c></r><r><id>1277035939</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>spoolsv.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\System32\\\\spoolsv.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1291572388</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>System Idle Process</v></c><c><v>[NO BIN]</v></c><c><v></v></c><c><v>0 {TCP/10.167.170.124:9443,TCP/10.167.170.124:17472,TCP/10.167.170.124:65046,TCP/10.167.170.124:65074,TCP/10.167.170.124:65116,TCP/10.167.170.124:65121,TCP/10.167.170.124:65151,TCP/127.0.0.1:9444,TCP/127.0.0.1:17472,TCP/127.0.0.1:65112,TCP/127.0.0.1:65123,TCP/127.0.0.1:65154,TCP/127.0.0.1:65158}</v></c><c><v>1</v></c></r><r><id>1298898850</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>php-cgi.exe</v></c><c><v>0d410f3ebe76bf7c0b45c47e67ca8de1 c:\\\\progra~1\\\\tanium\\\\tanium~1\\\\php55\\\\php-cgi.exe</v></c><c><v>C:\\\\PROGRA~1\\\\Tanium\\\\TANIUM~1\\\\php55\\\\php-cgi.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1333706542</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>conhost.exe</v></c><c><v>[NO BIN]</v></c><c><v>C:\\\\Windows\\\\System32\\\\WScript.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1467538242</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>System Idle Process</v></c><c><v>[NO BIN]</v></c><c><v></v></c><c><v>0 {TCP/192.168.12.27:53078,TCP/192.168.12.27:53079,TCP/192.168.12.27:53111,TCP/192.168.12.27:53114,TCP/192.168.12.27:53115,TCP/192.168.12.27:53144,TCP/192.168.12.27:53148,TCP/192.168.12.27:53149,TCP/192.168.12.27:53183,TCP/192.168.12.27:53184}</v></c><c><v>1</v></c></r><r><id>1467589887</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>services.exe</v></c><c><v>[NO BIN]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\winlogon.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1592719234</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>svchost.exe</v></c><c><v>d0abc231c0b3e88c6b612b28abbf734d c:\\\\windows\\\\system32\\\\svchost.exe</v></c><c><v>C:\\\\Windows\\\\System32\\\\svchost.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1674266488</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>smss.exe</v></c><c><v>[NO BIN]</v></c><c><v></v></c><c><v></v></c><c><v>1</v></c></r><r><id>1709652520</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>Ec2Config.exe</v></c><c><v>b3fde4699997759320cba603e2aed2cd c:\\\\program files\\\\amazon\\\\ec2configservice\\\\ec2config.exe</v></c><c><v>C:\\\\Program Files\\\\Amazon\\\\Ec2ConfigService\\\\Ec2Config.exe</v></c><c><v>1472 {TCP/192.168.12.27:53182}</v></c><c><v>1</v></c></r><r><id>1767938001</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>WmiPrvSE.exe</v></c><c><v>330c8cbd4343d04e72834b159d260e78 c:\\\\windows\\\\syswow64\\\\wbem\\\\wmiprvse.exe</v></c><c><v>C:\\\\Windows\\\\sysWOW64\\\\wbem\\\\wmiprvse.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>1851379401</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>cb.exe</v></c><c><v>d08f5c01b23aa7f356693c028ab592ba c:\\\\windows\\\\carbonblack\\\\cb.exe</v></c><c><v>C:\\\\Windows\\\\CarbonBlack\\\\cb.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2033331541</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>devenv.exe</v></c><c><v>b2a62caf90a30d233134c9ef7d2c73a7 c:\\\\program files (x86)\\\\microsoft visual studio 10.0\\\\common7\\\\ide\\\\devenv.exe</v></c><c><v>C:\\\\Program Files (x86)\\\\Microsoft Visual Studio 10.0\\\\Common7\\\\IDE\\\\devenv.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2070809886</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>wininit.exe</v></c><c><v>b5c5dcad3899512020d135600129d665 c:\\\\windows\\\\system32\\\\wininit.exe</v></c><c><v>C:\\\\Windows\\\\system32\\\\wininit.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2121839234</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>TaniumClient.exe</v></c><c><v>0db1ccd7230fdee1adb04e536ea60759 c:\\\\program files (x86)\\\\tanium\\\\tanium client\\\\taniumclient.exe</v></c><c><v>C:\\\\Program Files (x86)\\\\Tanium\\\\Tanium Client\\\\TaniumClient.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2179234476</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>Taskmgr.exe</v></c><c><v>9919d598108e8e449d98aba2c43d2f20 c:\\\\windows\\\\system32\\\\taskmgr.exe</v></c><c><v>C:\\\\Windows\\\\system32\\\\taskmgr.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2203176992</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>sh.exe</v></c><c><v>e890d295ab412762b7c3def0fdd9c16a c:\\\\cygwin64\\\\bin\\\\sh.exe</v></c><c><v>C:\\\\cygwin64\\\\bin\\\\sh.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2220592385</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>rdpclip.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\System32\\\\rdpclip.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2335124868</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>mmc.exe</v></c><c><v>b316385fd7c1e1cbad339c33cf3c0409 c:\\\\windows\\\\system32\\\\mmc.exe</v></c><c><v>C:\\\\Windows\\\\system32\\\\mmc.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2351261712</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>TaniumClient.exe</v></c><c><v>0db1ccd7230fdee1adb04e536ea60759 c:\\\\program files (x86)\\\\tanium\\\\tanium client\\\\taniumclient.exe</v></c><c><v>C:\\\\Program Files (x86)\\\\Tanium\\\\Tanium Client\\\\TaniumClient.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2384135557</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>lsass.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\lsass.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2393445266</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>httpd.exe</v></c><c><v>437a04590133ea73fb2078bf114ac542 c:\\\\program files\\\\tanium\\\\tanium server\\\\apache24\\\\bin\\\\httpd.exe</v></c><c><v>C:\\\\Program Files\\\\Tanium\\\\Tanium Server\\\\Apache24\\\\bin\\\\httpd.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2407801199</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>taskhostex.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\taskhostex.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2439515127</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>lsm.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\lsm.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2477658529</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>dwm.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\dwm.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2615369603</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>SQLAGENT.EXE</v></c><c><v>d72a162f3e75a046def27edaa92cdb67 c:\\\\program files\\\\microsoft sql server\\\\mssql12.mssqlserver\\\\mssql\\\\binn\\\\sqlagent.exe</v></c><c><v>C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL12.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\SQLAGENT.EXE</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2644508573</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>csrss.exe</v></c><c><v>[NO BIN]</v></c><c><v>C:\\\\Windows\\\\system32\\\\mmc.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2667342661</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>rdpinput.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\System32\\\\rdpinput.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2764744017</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>winlogon.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\winlogon.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2777407551</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>WmiPrvSE.exe</v></c><c><v>1951c6f1e53079f6b29ecff77eaf9403 c:\\\\windows\\\\syswow64\\\\wbem\\\\wmiprvse.exe</v></c><c><v>C:\\\\Windows\\\\sysWOW64\\\\wbem\\\\wmiprvse.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2818851634</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>csrss.exe</v></c><c><v>[NO BIN]</v></c><c><v></v></c><c><v></v></c><c><v>1</v></c></r><r><id>2860491008</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>NETSTAT.EXE</v></c><c><v>32297bb17e6ec700d0fc869f9acaf561 c:\\\\windows\\\\system32\\\\netstat.exe</v></c><c><v>C:\\\\Windows\\\\System32\\\\netstat.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2866659743</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>Ec2Config.exe</v></c><c><v>f02c17c6679c389cf49fe840f8df8089 c:\\\\program files\\\\amazon\\\\ec2configservice\\\\ec2config.exe</v></c><c><v>C:\\\\Program Files\\\\Amazon\\\\Ec2ConfigService\\\\Ec2Config.exe</v></c><c><v>2076 {TCP/10.167.170.124:65156}</v></c><c><v>1</v></c></r><r><id>2869899582</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>svchost.exe</v></c><c><v>54a47f6b5e09a77e61649109c6a08866 c:\\\\windows\\\\system32\\\\svchost.exe</v></c><c><v>C:\\\\Windows\\\\System32\\\\svchost.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>2957826223</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>nvwmi64.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\nvwmi64.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3034446139</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>taskhost.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\taskhost.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3084297043</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>mintty.exe</v></c><c><v>0c4ce674d7a2139d161c349cf468109c c:\\\\cygwin64\\\\bin\\\\mintty.exe</v></c><c><v>C:\\\\cygwin64\\\\bin\\\\mintty.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3092459201</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>msdtc.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\System32\\\\msdtc.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3108142843</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>WmiPrvSE.exe</v></c><c><v>1951c6f1e53079f6b29ecff77eaf9403 c:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe</v></c><c><v>C:\\\\Windows\\\\system32\\\\wbem\\\\wmiprvse.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3187118403</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>lsass.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\lsass.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3196297430</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>sqlservr.exe</v></c><c><v>5957dad9cec0dd7da81a3fcefe029dce c:\\\\program files\\\\microsoft sql server\\\\mssql12.mssqlserver\\\\mssql\\\\binn\\\\sqlservr.exe</v></c><c><v>C:\\\\Program Files\\\\Microsoft SQL Server\\\\MSSQL12.MSSQLSERVER\\\\MSSQL\\\\Binn\\\\sqlservr.exe</v></c><c><v>1352 {TCP/10.167.170.124:1433}</v></c><c><v>1</v></c></r><r><id>3273756515</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>csrss.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\csrss.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3306678053</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>WmiPrvSE.exe</v></c><c><v>330c8cbd4343d04e72834b159d260e78 c:\\\\windows\\\\system32\\\\wbem\\\\wmiprvse.exe</v></c><c><v>C:\\\\Windows\\\\system32\\\\wbem\\\\wmiprvse.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3352665611</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>conhost.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\conhost.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3374180811</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>csrss.exe</v></c><c><v>[NO BIN]</v></c><c><v>C:\\\\Windows\\\\System32\\\\Notepad.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3457634775</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>dwm.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\Dwm.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3542642798</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>TaniumReceiver.exe</v></c><c><v>2ba63ff4db05cbbd8bc93295fc2838f9 c:\\\\program files\\\\tanium\\\\tanium server\\\\taniumreceiver.exe</v></c><c><v>C:\\\\Program Files\\\\Tanium\\\\Tanium Server\\\\TaniumReceiver.exe</v></c><c><v>8064 {TCP/10.167.170.124:17472,TCP/10.167.170.124:49363,TCP/10.167.170.124:49364,TCP/10.167.170.124:49366,TCP/10.167.170.124:49367,TCP/10.167.170.124:49369,TCP/10.167.170.124:49370,TCP/10.167.170.124:49371,TCP/10.167.170.124:49373,TCP/10.167.170.124:49374,TCP/10.167.170.124:49379,TCP/10.167.170.124:49380,TCP/10.167.170.124:49382,TCP/10.167.170.124:49383,TCP/10.167.170.124:49384,TCP/10.167.170.124:49385,TCP/10.167.170.124:49386,TCP/10.167.170.124:49387,TCP/10.167.170.124:49388,TCP/10.167.170.124:49389,TCP/10.167.170.124:49390,TCP/10.167.170.124:49392,TCP/10.167.170.124:49393,TCP/10.167.170.124:49394,TCP/10.167.170.124:49395,TCP/10.167.170.124:49396,TCP/10.167.170.124:49397,TCP/10.167.170.124:49430,TCP/10.167.170.124:49448,TCP/10.167.170.124:53006,TCP/10.167.170.124:59480,TCP/127.0.0.1:17472}</v></c><c><v>1</v></c></r><r><id>3593426093</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>ServerManager.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\ServerManager.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3652869174</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>explorer.exe</v></c><c><v>85d47eb257b06094f052e0c8aefa3bee c:\\\\windows\\\\explorer.exe</v></c><c><v>C:\\\\Windows\\\\Explorer.EXE</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3666264833</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>OpenWith.exe</v></c><c><v>1dfe1ed0a9ef0fa4ffe8d08dfb00f121 c:\\\\windows\\\\system32\\\\openwith.exe</v></c><c><v>C:\\\\Windows\\\\system32\\\\OpenWith.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3806172439</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>LogonUI.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\LogonUI.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3869451342</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>firefox.exe</v></c><c><v>14cf73d771fa977a9f1cbaa5c301f912 c:\\\\program files (x86)\\\\mozilla firefox\\\\firefox.exe</v></c><c><v>C:\\\\Program Files (x86)\\\\Mozilla Firefox\\\\firefox.exe</v></c><c><v>3364 {TCP/127.0.0.1:56690,TCP/127.0.0.1:56691,TCP/192.168.12.27:57580,TCP/192.168.12.27:57582,TCP/192.168.12.27:57583}</v></c><c><v>1</v></c></r><r><id>3874003054</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>taskeng.exe</v></c><c><v>4f2659160afcca990305816946f69407 c:\\\\windows\\\\system32\\\\taskeng.exe</v></c><c><v>C:\\\\Windows\\\\system32\\\\taskeng.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3902538584</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>plugin_host.exe</v></c><c><v>85cfc4258e6538bc3f425edfe200a5a7 c:\\\\users\\\\akshat\\\\desktop\\\\sublime text build 3083 x64\\\\plugin_host.exe</v></c><c><v>C:\\\\Users\\\\akshat\\\\Desktop\\\\Sublime Text Build 3083 x64\\\\plugin_host.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3920685033</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>services.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\services.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>3960152428</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>dllhost.exe</v></c><c><v>cc05c14eeff5e7813a49718ba88e59b0 c:\\\\windows\\\\system32\\\\dllhost.exe</v></c><c><v>C:\\\\Windows\\\\system32\\\\DllHost.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>4074252443</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>VSSVC.exe</v></c><c><v>[Unable to process MD5]</v></c><c><v>C:\\\\Windows\\\\SysWow64\\\\vssvc.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>4198614073</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>XenGuestAgent.exe</v></c><c><v>7eae59832be1c3a08d4f94cebccaf13a c:\\\\program files (x86)\\\\citrix\\\\xentools\\\\xenguestagent.exe</v></c><c><v>C:\\\\Program Files (x86)\\\\Citrix\\\\XenTools\\\\XenGuestAgent.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>4252031705</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>notepad.exe</v></c><c><v>d378bffb70923139d6a4f546864aa61c c:\\\\windows\\\\system32\\\\notepad.exe</v></c><c><v>C:\\\\Windows\\\\System32\\\\Notepad.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>4254444053</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>nvSCPAPISvr.exe</v></c><c><v>701bb23989e138c1c8b436c5940a1f6e c:\\\\program files (x86)\\\\nvidia corporation\\\\3d vision\\\\nvscpapisvr.exe</v></c><c><v>C:\\\\Program Files (x86)\\\\NVIDIA Corporation\\\\3D Vision\\\\nvSCPAPISvr.exe</v></c><c><v></v></c><c><v>1</v></c></r><r><id>4263354092</id><cid>0</cid><c><v>RDP-GW</v></c><c><v>nvxdsync.exe</v></c><c><v>de701bee6a35ecd48c9a582bbff943c0 c:\\\\program files\\\\nvidia corporation\\\\display\\\\nvxdsync.exe</v></c><c><v>C:\\\\Program Files\\\\NVIDIA Corporation\\\\Display\\\\nvxdsync.exe</v></c><c><v></v></c><c><v>1</v></c></r></rs></result_set></result_sets>\\n\\n\"}";
        Record input = buildRecord(line);
        boolean result = doTest(input);
        assertEquals(true, result);
        OutUtils.printOut(this.outCommand.getNumRecords());
        Assert.assertEquals("number of records", 162, this.outCommand.getNumRecords());
        for (int i=0; i < this.outCommand.getNumRecords();i++) {
            Record out = this.outCommand.getRecord(i);
            out.removeAll("taniumMessage");
            OutUtils.printOut(String.format("%02d : %s", i, out));
            switch (i){
                case 0:
                    assertEquals("deviceHostName", "win-osnmci3gjj1", out.get("deviceHostName").get(0));
                    assertEquals("deviceNameOrIp", "WIN-OSNMCI3GJJ1", out.get("deviceNameOrIp").get(0));
                    assertEquals("externalLogSourceType", "tanium-Host-Processes details v2", out.get("externalLogSourceType").get(0));
                    assertEquals("logSourceType", "HostProcessMef", out.get("logSourceType").get(0));
                    assertEquals("processFileMd5", "1a62f67f5d9c292ba8a615ea6797966d", out.get("processFileMd5").get(0));
                    assertEquals("processFilePath", "C:\\Users\\akshat\\Desktop\\Sublime Text Build 3083 x64\\sublime_text.exe", out.get("processFilePath").get(0));
                    assertEquals("processName", "sublime_text.exe", out.get("processName").get(0));
                    assertEquals("startTime", 1433754090000L, out.get("startTime").get(0));
                    assertEquals("externalLogSourceType", "tanium-Host-Processes details v2", out.get("externalLogSourceType").get(0));

                    break;

                case 1:
                    assertEquals("deviceHostName", "rdp-gw", out.get("deviceHostName").get(0));
                    assertEquals("deviceNameOrIp", "RDP-GW", out.get("deviceNameOrIp").get(0));
                    assertEquals("externalLogSourceType", "tanium-Host-Processes details v2", out.get("externalLogSourceType").get(0));
                    assertEquals("logSourceType", "HostProcessMef", out.get("logSourceType").get(0));
                    assertEquals("processFileMd5", "6aaf3bece2c3d17091bcef37c5a82ac0", out.get("processFileMd5").get(0));
                    assertEquals("processFilePath", "C:\\Windows\\system32\\mmc.exe", out.get("processFilePath").get(0));
                    assertEquals("processName", "mmc.exe", out.get("processName").get(0));
                    assertEquals("startTime", 1433754090000L, out.get("startTime").get(0));
                    assertEquals("externalLogSourceType", "tanium-Host-Processes details v2", out.get("externalLogSourceType").get(0));

                    break;
                case 10:
                    assertEquals("cefSignatureId", "Seen", out.get("cefSignatureId").get(0));
                    assertEquals("deviceHostName", "win-osnmci3gjj1", out.get("deviceHostName").get(0));
                    assertEquals("deviceListenAddress", "127.0.0.1", out.get("deviceListenAddress").get(0));
                    assertEquals("deviceNameOrIp", "WIN-OSNMCI3GJJ1", out.get("deviceNameOrIp").get(0));
                    assertEquals("externalLogSourceType", "tanium-Host-Processes details v2", out.get("externalLogSourceType").get(0));
                    assertEquals("logSourceType", "HostPortMef", out.get("logSourceType").get(0));
                    assertEquals("processFileMd5", "345b45be09381d2011eb7f9ac11d8ac4", out.get("processFileMd5").get(0));
                    assertEquals("processFilePath", "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe", out.get("processFilePath").get(0));
                    assertEquals("processListenPort", 63700, out.get("processListenPort").get(0));
                    assertEquals("processName", "firefox.exe", out.get("processName").get(0));
                    assertEquals("startTime", 1433754090000L, out.get("startTime").get(0));
                    assertEquals("taniumQuestion", "Host-Processes details v2", out.get("taniumQuestion").get(0));
                    assertEquals("transportProtocol", "TCP", out.get("transportProtocol").get(0));
                    break;
                case 11:
                    assertEquals("cefSignatureId", "Seen", out.get("cefSignatureId").get(0));
                    assertEquals("deviceHostName", "win-osnmci3gjj1", out.get("deviceHostName").get(0));
                    assertEquals("deviceListenAddress", "127.0.0.1", out.get("deviceListenAddress").get(0));
                    assertEquals("deviceNameOrIp", "WIN-OSNMCI3GJJ1", out.get("deviceNameOrIp").get(0));
                    assertEquals("externalLogSourceType", "tanium-Host-Processes details v2", out.get("externalLogSourceType").get(0));
                    assertEquals("logSourceType", "HostPortMef", out.get("logSourceType").get(0));
                    assertEquals("processFileMd5", "345b45be09381d2011eb7f9ac11d8ac4", out.get("processFileMd5").get(0));
                    assertEquals("processFilePath", "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe", out.get("processFilePath").get(0));
                    assertEquals("processListenPort", 63701, out.get("processListenPort").get(0));
                    assertEquals("processName", "firefox.exe", out.get("processName").get(0));
                    assertEquals("startTime", 1433754090000L, out.get("startTime").get(0));
                    assertEquals("taniumQuestion", "Host-Processes details v2", out.get("taniumQuestion").get(0));
                    assertEquals("transportProtocol", "TCP", out.get("transportProtocol").get(0));
                    break;
                default:
            }
        }
    }

    @Test
    public void test_CpuAndMem() throws FileNotFoundException {
        String line = "{\"question\": \"HOST-CPU consumptions\", \"measure\": \"<result_sets><now>2015/05/29 14:38:51 GMT-0000</now>\\n<result_set><age>0</age><archived_question_id>0</archived_question_id><saved_question_id>233</saved_question_id><question_id>189709</question_id><report_count>3</report_count><seconds_since_issued>109</seconds_since_issued><issue_seconds>120</issue_seconds><expire_seconds>600</expire_seconds><tested>3</tested><passed>3</passed><mr_tested>3</mr_tested><mr_passed>3</mr_passed><estimated_total>3</estimated_total><select_count>1</select_count><cs><c><wh>98976143</wh><dn>Hostname</dn><rt>1</rt></c><c><wh>98976143</wh><dn>CPU Consumption</dn><rt>1</rt></c><c><wh>98976143</wh><dn>Mem Consumption</dn><rt>1</rt></c><c><wh>0</wh><dn>Count</dn><rt>3</rt></c></cs><filtered_row_count>3</filtered_row_count><filtered_row_count_machines>3</filtered_row_count_machines><item_count>3</item_count><rs><r><id>0</id><cid>0</cid><c><v>[no results]</v></c><c><v></v></c><c><v></v></c><c><v>1</v></c></r><r><id>1582003653</id><cid>0</cid><c><v>WIN-OSNMCI3GJJ1</v></c><c><v>2.15 %</v></c><c><v>34.97 %</v></c><c><v>1</v></c></r></rs></result_set></result_sets>\\n\\n\"}";
        Record input = buildRecord(line);
        boolean result = doTest(input);
        assertEquals(true, result);
        OutUtils.printOut(this.outCommand.getNumRecords());
        Assert.assertEquals("number of records", 1, this.outCommand.getNumRecords());
        for (int i=0; i < this.outCommand.getNumRecords();i++) {
            Record out = this.outCommand.getRecord(i);
            OutUtils.printOut(String.format("%02d : %s",i, out));
            switch (i){
                case 0:


                default:

            }
        }
    }

    /*@Test
    public void test1() throws FileNotFoundException {
        //
        String line = "{\"data\": {\"startTime\": \"1425684968.764013\", \"crt_md5\": \"FFFFFF5DFF16FF0EFF77FF0BFFFF3CFFFFFFD5\", \"crt_sln\": \"52FF27230842FF065AFF487B39FF6AFF00\", \"crt_issuer\": \"VeriSign Class 3 Secure Server CA - G3\", \"crt_noValidBefore\": \"140811000000Z\", \"crt_noValidAfter\": \"151102235959Z\", \"crt_commonName\": \"textchat.bankofamerica.com\", \"crt_subjAltName\": \"textchat.bankofamerica.com\"}, \"net\": {\"destNameOrIp\": \"208.89.15.8\", \"sourceNameOrIp\": \"192.168.1.56\", \"sourcePort\": \"53232\", \"destPort\": \"443\", \"transportProtocol\": \"tcp\", \"timestamp\": 1425684968, \"application\": \"ssl\", \"dpiFlowId\": \"5\"}, \"dpiSignatureId\": \"SSL CERTIFICATE\"}";
        Record input = buildRecord(line);
        boolean result = doTest(input);
        assertEquals(true, result);
        OutUtils.printOut(this.outCommand.getNumRecords());
        Assert.assertTrue(this.outCommand.getNumRecords() == 1);

        Record out = this.outCommand.getRecord(0);

        assertEquals("certCommonName", "textchat.bankofamerica.com", out.get("certCommonName").get(0));
        assertEquals("certIssuer", "VeriSign Class 3 Secure Server CA - G3", out.get("certIssuer").get(0));
        assertEquals("certMd5", "FFFFFF5DFF16FF0EFF77FF0BFFFF3CFFFFFFD5", out.get("certMd5").get(0));
        //Mon, 02 Nov 2015 23:59:59 GMT
        assertEquals("certNoValidAfter", 1446508799000L, out.get("certNoValidAfter").get(0));
        //Mon, 11 Aug 2014 00:00:00 GMT
        assertEquals("certNoValidBefore", 1407715200000L, out.get("certNoValidBefore").get(0));
        assertEquals("certSerial", "52FF27230842FF065AFF487B39FF6AFF00", out.get("certSerial").get(0));
        assertEquals("certSubject", "textchat.bankofamerica.com", out.get("certSubject").get(0));
        assertEquals("destinationNameOrIp", "208.89.15.8", out.get("destinationNameOrIp").get(0));
        assertEquals("destinationPort", 443, out.get("destinationPort").get(0));
        assertEquals("dpiSignatureId", "SSL CERTIFICATE", out.get("dpiSignatureId").get(0));
        assertEquals("externalLogSourceType", "Dpi-ssl", out.get("externalLogSourceType").get(0));
        assertEquals("logSourceType", "CertMef", out.get("logSourceType").get(0));
        assertEquals("sourceAddress", "192.168.1.56", out.get("sourceAddress").get(0));
        assertEquals("sourceNameOrIp", "192.168.1.56", out.get("sourceNameOrIp").get(0));
        assertEquals("sourcePort", 53232, out.get("sourcePort").get(0));
        assertEquals("startTime", 1425684968764L, out.get("startTime").get(0));
        assertEquals("transportProtocol", "tcp", out.get("transportProtocol").get(0));
    }

      */


}
