package com.securityx.model.mef.morphline.command.windows;

import com.securityx.model.mef.morphline.command.LogCollectionAbstractTest;
import com.securityx.utils.OutUtils;
import junit.framework.Assert;
import org.kitesdk.morphline.api.Record;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.testng.annotations.Test;

import java.io.FileNotFoundException;

public class MefCefADSnareScriptTest extends LogCollectionAbstractTest {

    private Logger logger = LoggerFactory.getLogger(MefCefADSnareScriptTest.class);

    public MefCefADSnareScriptTest() {
        super(MefCefADSnareScriptTest.class.toString());
        this.morphlineId = "cefnew";
        //this.morphlineId = "ceffromsyslogmissinghost";
        this.confFile = "logcollection-cef.conf";
        this.verboseOutputCommand = false;
    }
    /*
    //perf test
    @Test
    public void testPerf() throws FileNotFoundException {
        String line = "CEF:0|IntersectAlliance|Snare||Microsoft-Windows-Security-Auditing:4769|A Kerberos service ticket was requested|Low| eventId=975425144 externalId=4769 msg=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.  categorySignificance=/Normal categoryBehavior=/Authentication/Verify categoryDeviceGroup=/Operating System catdt=Log Consolidator categoryOutcome=/Attempt categoryObject=/Host/Operating System art=1434663284564 cat=Security deviceSeverity=4 rt=1434652483000 spt=64304 dhost=XXXXX.RB.AD.JPMORGANCHASE.COM dntdom=JPMORGANCHASE.COM duser=XX1111111111112$@JPMORGANCHASE.COM destinationServiceName=krbtgt/JPMORGANCHASE.COM cs2=Kerberos Service Ticket Operations cs3=::ffff:10.9.7.5 cs4=0xe cs6={00000000-0000-0000-0000-000000000000} c6a2=0:0:0:0:0:ffff::a5 cs1Label=Accesses cs2Label=EventlogCategory cs3Label=Client Address cs4Label=Reason or Error Code cs5Label=Authentication Package Name cs6Label=Logon GUID cn1Label=LogonType cn2Label=CrashOnAuditFail cn3Label=Count c6a2Label=Source IPv6 Address ahost=host1.svr.us.jpmchase.net agt=10.5.137.64 agentZoneURI=/All Zones/ArcSight System/Public Address Space Zones/ARIN/164.0.0.0-169.253.255.255 (ARIN) av=7.0.5.7132.0 atz=America/New_York aid=3Kwbn4UkBABCBy0OBjJe9TA\\=\\= at=syslog dvchost=XXXXX.JPMORGANCHASE.COM dtz=America/New_York _cefVer=0.1 ad.ExtraParam0=This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested. ad.Service_,Information:Service_,ID=S-1-0-0 ad.Additional_,InMbHgGQ_~_~Ticket_,Options=0x60810010 ad.Additional_,Inc1+cZg_~_~sited_,Services=- ad.ExtraParam1=This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket. ad.ExtraParam2=Ticket options, encryption types, and failure codes are defined in RFC 4120. ad.Additional_,InagWMqg_~_~ncryption_,Type=0xffffffff ad.message=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.     User: JPMORGANCHASE.COM\\\\XX1111111111112$@JPMORGANCHASE.COM     ComputerName: XXXXX.JPMORGANCHASE.COM\n";
        //     line = "10/31/2013 23:59:12 CEF:0|ForeScout Technologies|CounterAct|6.3.4|NONCOMPLIANCE|host is not compliant|5|cs1Label=Compliancy Policy Name cs2Label=Compliancy Policy Subrule Name cs3Label=Host Compliancy Status cs4Label=Compliancy Event Trigger cs1=Security policy  cs2=Test failed cs3=no cs4=CounterAct Action dmac=00:03:47:24:46:10 dst=10.10.1.8 dntdom=mydomain.com dhost=wks-105 duser=Dick_Dietz dvc=1.1.1.2 dvchost=forescout-02 rt=1328814511000";
        Record r = new Record();
        r.put("syslogMessage", line);
        Record[] recArray = new Record[10000]
                ;

        boolean result = false;
        for (int j=0; j<10; j++) {
            for (int i=0; i < recArray.length; i++){
                recArray[i]=r.copy();
            }
            result = doTest(recArray);
            this.outCommand.clear();
        }

        assertEquals(true, result);
    }
    */


    @Test
    public void test0() throws FileNotFoundException {
        String line = "CEF:0|IntersectAlliance|Snare||Microsoft-Windows-Security-Auditing:4769|A Kerberos service ticket was requested|Low| eventId=975425144 externalId=4769 msg=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.  categorySignificance=/Normal categoryBehavior=/Authentication/Verify categoryDeviceGroup=/Operating System catdt=Log Consolidator categoryOutcome=/Attempt categoryObject=/Host/Operating System art=1434663284564 cat=Security deviceSeverity=4 rt=1434652483000 spt=64304 dhost=XXXXX.RB.AD.JPMORGANCHASE.COM dntdom=JPMORGANCHASE.COM duser=XX1111111111112$@JPMORGANCHASE.COM destinationServiceName=krbtgt/JPMORGANCHASE.COM cs2=Kerberos Service Ticket Operations cs3=::ffff:10.9.7.5 cs4=0xe cs6={00000000-0000-0000-0000-000000000000} c6a2=0:0:0:0:0:ffff::a5 cs1Label=Accesses cs2Label=EventlogCategory cs3Label=Client Address cs4Label=Reason or Error Code cs5Label=Authentication Package Name cs6Label=Logon GUID cn1Label=LogonType cn2Label=CrashOnAuditFail cn3Label=Count c6a2Label=Source IPv6 Address ahost=host1.svr.us.jpmchase.net agt=10.5.137.64 agentZoneURI=/All Zones/ArcSight System/Public Address Space Zones/ARIN/164.0.0.0-169.253.255.255 (ARIN) av=7.0.5.7132.0 atz=America/New_York aid=3Kwbn4UkBABCBy0OBjJe9TA\\=\\= at=syslog dvchost=XXXXX.JPMORGANCHASE.COM dtz=America/New_York _cefVer=0.1 ad.ExtraParam0=This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested. ad.Service_,Information:Service_,ID=S-1-0-0 ad.Additional_,InMbHgGQ_~_~Ticket_,Options=0x60810010 ad.Additional_,Inc1+cZg_~_~sited_,Services=- ad.ExtraParam1=This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket. ad.ExtraParam2=Ticket options, encryption types, and failure codes are defined in RFC 4120. ad.Additional_,InagWMqg_~_~ncryption_,Type=0xffffffff ad.message=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.     User: JPMORGANCHASE.COM\\\\XX1111111111112$@JPMORGANCHASE.COM     ComputerName: XXXXX.JPMORGANCHASE.COM\n";
        //     line = "10/31/2013 23:59:12 CEF:0|ForeScout Technologies|CounterAct|6.3.4|NONCOMPLIANCE|host is not compliant|5|cs1Label=Compliancy Policy Name cs2Label=Compliancy Policy Subrule Name cs3Label=Host Compliancy Status cs4Label=Compliancy Event Trigger cs1=Security policy  cs2=Test failed cs3=no cs4=CounterAct Action dmac=00:03:47:24:46:10 dst=10.10.1.8 dntdom=mydomain.com dhost=wks-105 duser=Dick_Dietz dvc=1.1.1.2 dvchost=forescout-02 rt=1328814511000";
        Record r = new Record();
        r.put("syslogMessage", line);
        boolean result = doTest(r);

        assertEquals(true, result);
    }

    @Test
    public void test4() throws FileNotFoundException {
        //
        String line = "CEF:0|IntersectAlliance|Snare||Microsoft-Windows-Security-Auditing:4769|A Kerberos service ticket was requested|Low| eventId=975425144 externalId=4769 msg=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.  categorySignificance=/Normal categoryBehavior=/Authentication/Verify categoryDeviceGroup=/Operating System catdt=Log Consolidator categoryOutcome=/Attempt categoryObject=/Host/Operating System art=1434663284564 cat=Security deviceSeverity=4 rt=1434652483000 spt=64304 dhost=XXXXX.RB.AD.JPMORGANCHASE.COM dntdom=JPMORGANCHASE.COM duser=XX1111111111112$@JPMORGANCHASE.COM destinationServiceName=krbtgt/JPMORGANCHASE.COM cs2=Kerberos Service Ticket Operations cs3=::ffff:10.9.7.5 cs4=0xe cs6={00000000-0000-0000-0000-000000000000} c6a2=0:0:0:0:0:ffff::a5 cs1Label=Accesses cs2Label=EventlogCategory cs3Label=Client Address cs4Label=Reason or Error Code cs5Label=Authentication Package Name cs6Label=Logon GUID cn1Label=LogonType cn2Label=CrashOnAuditFail cn3Label=Count c6a2Label=Source IPv6 Address ahost=host1.svr.us.jpmchase.net agt=10.5.137.64 agentZoneURI=/All Zones/ArcSight System/Public Address Space Zones/ARIN/164.0.0.0-169.253.255.255 (ARIN) av=7.0.5.7132.0 atz=America/New_York aid=3Kwbn4UkBABCBy0OBjJe9TA\\=\\= at=syslog dvchost=XXXXX.JPMORGANCHASE.COM dtz=America/New_York _cefVer=0.1 ad.ExtraParam0=This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested. ad.Service_,Information:Service_,ID=S-1-0-0 ad.Additional_,InMbHgGQ_~_~Ticket_,Options=0x60810010 ad.Additional_,Inc1+cZg_~_~sited_,Services=- ad.ExtraParam1=This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket. ad.ExtraParam2=Ticket options, encryption types, and failure codes are defined in RFC 4120. ad.Additional_,InagWMqg_~_~ncryption_,Type=0xffffffff ad.message=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.     User: JPMORGANCHASE.COM\\\\XX1111111111112$@JPMORGANCHASE.COM     ComputerName: XXXXX.JPMORGANCHASE.COM";
        Record r = new Record();
        r.put("syslogMessage", line);
        boolean result = doTest(r);

        assertEquals(true, result);
        OutUtils.printOut(this.outCommand.getNumRecords());
        Assert.assertTrue(this.outCommand.getNumRecords() == 1);
        Record res = this.outCommand.getRecord(0);
        assertEquals("_cefVer", "0.1", res.get("_cefVer").get(0));
        assertEquals("ad.ExtraParam0", "This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested. ad.Service_,Information:Service_,ID=S-1-0-0 ad.Additional_,InMbHgGQ_~_~Ticket_,Options=0x60810010 ad.Additional_,Inc1+cZg_~_~sited_,Services=-", res.get("ad.ExtraParam0").get(0));
        assertEquals("ad.ExtraParam1", "This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.", res.get("ad.ExtraParam1").get(0));
        assertEquals("ad.ExtraParam2", "Ticket options, encryption types, and failure codes are defined in RFC 4120. ad.Additional_,InagWMqg_~_~ncryption_,Type=0xffffffff", res.get("ad.ExtraParam2").get(0));
        assertEquals("ad.message", "Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.     User: JPMORGANCHASE.COM\\\\XX1111111111112$@JPMORGANCHASE.COM     ComputerName: XXXXX.JPMORGANCHASE.COM", res.get("ad.message").get(0));
        assertEquals("agentZoneURI", "/All Zones/ArcSight System/Public Address Space Zones/ARIN/164.0.0.0-169.253.255.255 (ARIN)", res.get("agentZoneURI").get(0));
        assertEquals("agt", "10.5.137.64", res.get("agt").get(0));
        assertEquals("ahost", "host1.svr.us.jpmchase.net", res.get("ahost").get(0));
        assertEquals("aid", "3Kwbn4UkBABCBy0OBjJe9TA\\=\\=", res.get("aid").get(0));
        assertEquals("art", "1434663284564", res.get("art").get(0));
        assertEquals("at", "syslog", res.get("at").get(0));
        assertEquals("atz", "America/New_York", res.get("atz").get(0));
        assertEquals("av", "7.0.5.7132.0", res.get("av").get(0));
        assertEquals("c6a2", "0:0:0:0:0:ffff::a5", res.get("c6a2").get(0));
        assertEquals("c6a2Label", "Source IPv6 Address", res.get("c6a2Label").get(0));
        assertEquals("cat", "Security", res.get("cat").get(0));
        assertEquals("catdt", "Log Consolidator", res.get("catdt").get(0));
        assertEquals("categoryBehavior", "/Authentication/Verify", res.get("categoryBehavior").get(0));
        assertEquals("categoryDeviceGroup", "/Operating System", res.get("categoryDeviceGroup").get(0));
        assertEquals("categoryObject", "/Host/Operating System", res.get("categoryObject").get(0));
        assertEquals("categoryOutcome", "/Attempt", res.get("categoryOutcome").get(0));
        assertEquals("categorySignificance", "/Normal", res.get("categorySignificance").get(0));
        assertEquals("cefDeviceProduct", "Snare", res.get("cefDeviceProduct").get(0));
        assertEquals("cefDeviceVendor", "IntersectAlliance", res.get("cefDeviceVendor").get(0));
        assertEquals("cefEventName", "A Kerberos service ticket was requested", res.get("cefEventName").get(0));
        assertEquals("cefEventSeverity", "Low", res.get("cefEventSeverity").get(0));
        assertEquals("cefExtensionData", "eventId=975425144 externalId=4769 msg=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.  categorySignificance=/Normal categoryBehavior=/Authentication/Verify categoryDeviceGroup=/Operating System catdt=Log Consolidator categoryOutcome=/Attempt categoryObject=/Host/Operating System art=1434663284564 cat=Security deviceSeverity=4 rt=1434652483000 spt=64304 dhost=XXXXX.RB.AD.JPMORGANCHASE.COM dntdom=JPMORGANCHASE.COM duser=XX1111111111112$@JPMORGANCHASE.COM destinationServiceName=krbtgt/JPMORGANCHASE.COM cs2=Kerberos Service Ticket Operations cs3=::ffff:10.9.7.5 cs4=0xe cs6={00000000-0000-0000-0000-000000000000} c6a2=0:0:0:0:0:ffff::a5 cs1Label=Accesses cs2Label=EventlogCategory cs3Label=Client Address cs4Label=Reason or Error Code cs5Label=Authentication Package Name cs6Label=Logon GUID cn1Label=LogonType cn2Label=CrashOnAuditFail cn3Label=Count c6a2Label=Source IPv6 Address ahost=host1.svr.us.jpmchase.net agt=10.5.137.64 agentZoneURI=/All Zones/ArcSight System/Public Address Space Zones/ARIN/164.0.0.0-169.253.255.255 (ARIN) av=7.0.5.7132.0 atz=America/New_York aid=3Kwbn4UkBABCBy0OBjJe9TA\\=\\= at=syslog dvchost=XXXXX.JPMORGANCHASE.COM dtz=America/New_York _cefVer=0.1 ad.ExtraParam0=This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested. ad.Service_,Information:Service_,ID=S-1-0-0 ad.Additional_,InMbHgGQ_~_~Ticket_,Options=0x60810010 ad.Additional_,Inc1+cZg_~_~sited_,Services=- ad.ExtraParam1=This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket. ad.ExtraParam2=Ticket options, encryption types, and failure codes are defined in RFC 4120. ad.Additional_,InagWMqg_~_~ncryption_,Type=0xffffffff ad.message=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.     User: JPMORGANCHASE.COM\\\\XX1111111111112$@JPMORGANCHASE.COM     ComputerName: XXXXX.JPMORGANCHASE.COM", res.get("cefExtensionData").get(0));
        assertEquals("cefHeader", "CEF:0", res.get("cefHeader").get(0));
        assertEquals("cefHeaderVersion", "0", res.get("cefHeaderVersion").get(0));
        assertEquals("cefSignatureId", "Microsoft-Windows-Security-Auditing:4769", res.get("cefSignatureId").get(0));
        assertEquals("cn1Label", "LogonType", res.get("cn1Label").get(0));
        assertEquals("cn2Label", "CrashOnAuditFail", res.get("cn2Label").get(0));
        assertEquals("cn3Label", "Count", res.get("cn3Label").get(0));
        assertEquals("cs1Label", "Accesses", res.get("cs1Label").get(0));
        assertEquals("cs2", "Kerberos Service Ticket Operations", res.get("cs2").get(0));
        assertEquals("cs2Label", "EventlogCategory", res.get("cs2Label").get(0));
        assertEquals("cs3", "::ffff:10.9.7.5", res.get("cs3").get(0));
        assertEquals("cs3Label", "Client Address", res.get("cs3Label").get(0));
        assertEquals("cs4", "0xe", res.get("cs4").get(0));
        assertEquals("cs4Label", "Reason or Error Code", res.get("cs4Label").get(0));
        assertEquals("cs5Label", "Authentication Package Name", res.get("cs5Label").get(0));
        assertEquals("cs6", "{00000000-0000-0000-0000-000000000000}", res.get("cs6").get(0));
        assertEquals("cs6Label", "Logon GUID", res.get("cs6Label").get(0));
        assertEquals("destinationServiceName", "krbtgt/JPMORGANCHASE.COM", res.get("destinationServiceName").get(0));
        assertEquals("dhost", "XXXXX.RB.AD.JPMORGANCHASE.COM", res.get("dhost").get(0));
        assertEquals("dntdom", "JPMORGANCHASE.COM", res.get("dntdom").get(0));
        assertEquals("dtz", "America/New_York", res.get("dtz").get(0));
        assertEquals("duser", "XX1111111111112$@JPMORGANCHASE.COM", res.get("duser").get(0));
        assertEquals("dvchost", "XXXXX.JPMORGANCHASE.COM", res.get("dvchost").get(0));
        assertEquals("externalId", "4769", res.get("externalId").get(0));
        assertEquals("msg", "Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.", res.get("msg").get(0));
        assertEquals("rt", "1434652483000", res.get("rt").get(0));
        assertEquals("spt", "64304", res.get("spt").get(0));
        assertEquals("syslogMessage", "CEF:0|IntersectAlliance|Snare||Microsoft-Windows-Security-Auditing:4769|A Kerberos service ticket was requested|Low| eventId=975425144 externalId=4769 msg=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.  categorySignificance=/Normal categoryBehavior=/Authentication/Verify categoryDeviceGroup=/Operating System catdt=Log Consolidator categoryOutcome=/Attempt categoryObject=/Host/Operating System art=1434663284564 cat=Security deviceSeverity=4 rt=1434652483000 spt=64304 dhost=XXXXX.RB.AD.JPMORGANCHASE.COM dntdom=JPMORGANCHASE.COM duser=XX1111111111112$@JPMORGANCHASE.COM destinationServiceName=krbtgt/JPMORGANCHASE.COM cs2=Kerberos Service Ticket Operations cs3=::ffff:10.9.7.5 cs4=0xe cs6={00000000-0000-0000-0000-000000000000} c6a2=0:0:0:0:0:ffff::a5 cs1Label=Accesses cs2Label=EventlogCategory cs3Label=Client Address cs4Label=Reason or Error Code cs5Label=Authentication Package Name cs6Label=Logon GUID cn1Label=LogonType cn2Label=CrashOnAuditFail cn3Label=Count c6a2Label=Source IPv6 Address ahost=host1.svr.us.jpmchase.net agt=10.5.137.64 agentZoneURI=/All Zones/ArcSight System/Public Address Space Zones/ARIN/164.0.0.0-169.253.255.255 (ARIN) av=7.0.5.7132.0 atz=America/New_York aid=3Kwbn4UkBABCBy0OBjJe9TA\\=\\= at=syslog dvchost=XXXXX.JPMORGANCHASE.COM dtz=America/New_York _cefVer=0.1 ad.ExtraParam0=This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested. ad.Service_,Information:Service_,ID=S-1-0-0 ad.Additional_,InMbHgGQ_~_~Ticket_,Options=0x60810010 ad.Additional_,Inc1+cZg_~_~sited_,Services=- ad.ExtraParam1=This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket. ad.ExtraParam2=Ticket options, encryption types, and failure codes are defined in RFC 4120. ad.Additional_,InagWMqg_~_~ncryption_,Type=0xffffffff ad.message=Account Information:   Account Name:  XX1111111111112$@JPMORGANCHASE.COM   Account Domain:  JPMORGANCHASE.COM   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  krbtgt/JPMORGANCHASE.COM   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:10.9.7.5   Client Port:  64304    Additional Information:   Ticket Options:  0x60810010   Ticket Encryption Type: 0xffffffff   Failure Code:  0xe   Transited Services: -    This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.    This event can be correlated with Windows logon events by comparing the Logon GUID fields in each event.  The logon event occurs on the machine that was accessed, which is often a different machine than the domain controller which issued the service ticket.    Ticket options, encryption types, and failure codes are defined in RFC 4120.     User: JPMORGANCHASE.COM\\\\XX1111111111112$@JPMORGANCHASE.COM     ComputerName: XXXXX.JPMORGANCHASE.COM", res.get("syslogMessage").get(0));

    }

}
